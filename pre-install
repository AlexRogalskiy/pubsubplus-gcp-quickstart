
# Get repositories up to date
yum -y update
yum -y install lvm2
yum -y install wget

# Get Docker in place
wget https://raw.githubusercontent.com/KenBarr/solace-gcp-quickstart/master/docker.repo
mv docker.repo /etc/yum.repos.d/

yum -y install docker-engine

wget https://raw.githubusercontent.com/KenBarr/solace-gcp-quickstart/master/docker.conf
mkdir /etc/systemd/system/docker.service.d
mv docker.conf /etc/systemd/system/docker.service.d

systemctl enable docker 
systemctl start docker


# Pre-Define Solace required infrastructure
docker volume create --name=jail 
docker volume create --name=var 
docker volume create --name=internalSpool 
docker volume create --name=adbBackup 
docker volume create --name=softAdb

# Set up for first-run 
wget https://raw.githubusercontent.com/KenBarr/solace-gcp-quickstart/master/solace-first-boot.service
mv solace-first-boot.service /etc/systemd/system/
systemctl enable solace-first-boot

wget https://raw.githubusercontent.com/KenBarr/solace-gcp-quickstart/master/solace-first-boot.sh
mv solace-first-boot.sh /usr/local/sbin
chmod +x /usr/local/sbin/solace-first-boot.sh 
